{
	"name": "Local dev", // this name is printed in the lower left corner when run in container
	"build": {
		"dockerfile": "Dockerfile.generated", // this file is generated by initialize.sh
		"context": "..", // The docker build context is the parent folder
		"args": {
			"USERNAME": "${localEnv:USER}" // let's pass your username to the build, so you're called the same in the image
		}
	},
	"initializeCommand": ".devcontainer/initialize.sh", // Where a bunch of magic happens before we start the container
	"mounts": [
		// Google credentials & conf from user machine
		"source=${localEnv:HOME}/.config/gcloud,target=/home/${localEnv:USER}/.config/gcloud,type=bind,consistency=cached",
		// Kubernetes credentials & conf from user machine
		"source=${localEnv:HOME}/.kube,target=/home/${localEnv:USER}/.kube,type=bind,consistency=cached",
		// bashrc from .devcontainer/.bashrc
		"source=${localWorkspaceFolder}/.devcontainer/.bashrc,target=/home/${localEnv:USER}/.bashrc,type=bind,consistency=cached",
		// A volume for bash history
		"source=commandhistory-volume,target=/commandhistory,type=volume"
	],
	"containerEnv": {
		// Since we'll build python thingies, add our python src folder to
		// pythonpath
		"PYTHONPATH": "/workspaces/example-remote-container/src/:${PYTHONPATH}",
		// this just disables a warning in jupyter
		"PYDEVD_DISABLE_FILE_VALIDATION": "1"
	},
	"runArgs": [
		// The env file is generated in initialize.sh ,
		"--env-file",
		".devcontainer/container.env.generated",
		// Using the host network is not required, but I find it's faster
		"--network",
		"host"
	],
	"customizations": {
		// Any VSCode settings.json that users of this repo will inherit
		"vscode": {
			"settings": {
				"files.trimTrailingWhitespace": true,
				// restore terminals allow us to start terminals with
				// processes in them on container start, this is awesome
				// e.g. to launch a proxy server or notebooks or w/e
				"restoreTerminals.terminals": [
					{
						"splitTerminals": [
							{
								"name": "Jupyter Server",
								"commands": [
									"jupyter-lab"
								],
								"shouldRunCommands": true
							}
						]
					},
					{
						"splitTerminals": [
							{
								"name": "Terminal",
								"commands": ["some_command"], // this is just a dummy command from the bin folder
								"shouldRunCommands": true
							}
						]
					}
				],
				"terminal.integrated.defaultProfile.linux": "bash",
				"terminal.integrated.profiles.linux": {
					"bash": {
						"path": "/bin/bash"
					}
				},
				"python.pythonPath": "/usr/local/bin/python",
				"python.languageServer": "Pylance"
			},
			// Extensions to automatically install
			"extensions": [
				"ms-python.python",
				"visualstudioexptteam.vscodeintellicode",
				"emeraldwalk.RunOnSave",
				"ethansk.restore-terminals"
			]
		}
	},
	// The container user to run as, avoid root
	"remoteUser": "${localEnv:USER}"
}